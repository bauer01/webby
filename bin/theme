#!/usr/bin/env php
<?php

// Load DI container
$container = require __DIR__ . '/../app/bootstrap.php';

$application = new \Symfony\Component\Console\Application();
$application->addCommands([
    new \Webby\Console\Theme\Current\GetLayoutCommand(
        $container->getByType(\Webby\System\Theme::class)
    ),
    new \Webby\Console\Theme\Current\GetLayoutsCommand(
        $container->getByType(\Webby\System\Theme::class)
    ),
    new \Webby\Console\Theme\Current\GetParticlesCommand(
        $container->getByType(\Webby\System\Theme::class),
        $container->getByType(\Webby\System\Particles::class)
    ),
    new \Webby\Console\Theme\Current\UpdateLayoutCommand(
        $container->getByType(\Webby\System\Theme::class)
    ),
    new \Webby\Console\Theme\Current\CreateLayoutCommand(
        $container->getByType(\Webby\System\Theme::class)
    ),
    new \Webby\Console\Theme\Current\DeleteLayoutCommand(
        $container->getByType(\Webby\System\Theme::class)
    )
]);

$application->setCatchExceptions(false);
try {
    $output = new Symfony\Component\Console\Output\ConsoleOutput();
    $application->run(null, $output);
} catch (Exception $e) {

    $application->renderException($e, $output);

    \Tracy\Debugger::log($e);
    $statusCode = $e->getCode();
    $statusCode = is_numeric($statusCode) && $statusCode ? $statusCode : 1;
    exit($statusCode);
}